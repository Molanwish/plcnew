# è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿå®æ–½æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 èƒŒæ™¯ä¸ç›®æ ‡

ç§°é‡åŒ…è£…æ§åˆ¶ç³»ç»Ÿç›®å‰å·²å®ç°åŸºç¡€çš„è‡ªé€‚åº”æ§åˆ¶ç®—æ³•ï¼Œä½†è¯¥ç®—æ³•åœ¨å‚æ•°ä¼˜åŒ–å’Œè‡ªæˆ‘çº æ­£èƒ½åŠ›æ–¹é¢å­˜åœ¨å±€é™æ€§ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºå®æ–½ä¸€ä¸ªå…·å¤‡çœŸæ­£è‡ªå­¦ä¹ å’Œè‡ªæˆ‘ä¿®æ­£èƒ½åŠ›çš„å¢å¼ºç³»ç»Ÿã€‚

**æ ¸å¿ƒç›®æ ‡**ï¼š
- å»ºç«‹ç»“æ„åŒ–çš„æ•°æ®æ”¶é›†å’Œåˆ†ææœºåˆ¶
- å®ç°åŸºäºå†å²æ•°æ®çš„å‚æ•°æ•æ„Ÿåº¦åˆ†æ
- å¼€å‘ç‰©æ–™ç‰¹æ€§è¯†åˆ«å’Œåˆ†ç±»åŠŸèƒ½
- æä¾›æ™ºèƒ½å‚æ•°è°ƒæ•´å’Œæ¨èç³»ç»Ÿ
- å¯è§†åŒ–å­¦ä¹ è¿‡ç¨‹å’Œç³»ç»Ÿæ€§èƒ½

### 1.2 å…³é”®åŸåˆ™

- **æœ€å°ä¾µå…¥æ€§**ï¼šå°½é‡ä¸ä¿®æ”¹ç°æœ‰ä»£ç ï¼Œé€šè¿‡ç»§æ‰¿å’Œç»„åˆæ–¹å¼æ‰©å±•åŠŸèƒ½
- **æ¸è¿›å¼å®æ–½**ï¼šåˆ†é˜¶æ®µå®æ–½ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½èƒ½ç‹¬ç«‹è¿è¡Œå¹¶äº§ç”Ÿä»·å€¼
- **å¯å›é€€è®¾è®¡**ï¼šä¿ç•™åˆ‡æ¢å›åŸå§‹ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œé™ä½é£é™©
- **æ•°æ®é©±åŠ¨**ï¼šæ‰€æœ‰ä¼˜åŒ–å†³ç­–åŸºäºå¯éªŒè¯çš„å†å²æ•°æ®åˆ†æ
- **é€æ˜å¯è§£é‡Š**ï¼šç³»ç»Ÿçš„å­¦ä¹ è¿‡ç¨‹å’Œå†³ç­–ä¾æ®å¯¹ç”¨æˆ·é€æ˜å¯è§

## 2. ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                   â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®å­˜å‚¨å±‚  â”‚  â”‚   ç®—æ³•æ§åˆ¶å±‚    â”‚  â”‚   ç”¨æˆ·ç•Œé¢å±‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚                    â”‚
     â–¼                   â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚LearningDataRepoâ”‚ â”‚AdaptiveControllerâ”‚ â”‚å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–    â”‚
â”‚              â”‚  â”‚WithMicroAdjustmentâ”‚ â”‚å‚æ•°æ•æ„Ÿåº¦æŠ¥è¡¨    â”‚
â”‚- åŒ…è£…è®°å½•    â”‚  â”‚                 â”‚  â”‚å‚æ•°æ¨èç•Œé¢      â”‚
â”‚- å‚æ•°è°ƒæ•´å†å²â”‚  â”‚- å¾®è°ƒç­–ç•¥       â”‚  â”‚                  â”‚
â”‚- æ•æ„Ÿåº¦åˆ†æ  â”‚  â”‚- ç‰©æ–™ç‰¹æ€§è¯†åˆ«   â”‚  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸ç°æœ‰ç³»ç»Ÿå…³ç³»

æ–°ç³»ç»Ÿå°†é€šè¿‡ç»§æ‰¿å’Œç»„åˆæ–¹å¼ä¸ç°æœ‰ç³»ç»Ÿé›†æˆï¼Œä¿æŒé«˜åº¦å…¼å®¹æ€§ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç°æœ‰æ¶æ„                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚AdaptiveControllerâ”‚â—„â”€â”€â”€â”¬â”€â”€â”€ ç»§æ‰¿æ‰©å±•
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚          â”‚              â”‚    â”‚
â”‚          â–¼              â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚SmartProductionTabâ”‚â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€ åŠŸèƒ½æ‰©å±•
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
                               â”‚    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚ æ–°å¢æ¶æ„                â”‚    â”‚    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚AdaptiveControllerWithâ”œâ”€â”€â”€â”€â”˜    â”‚
â”‚  â”‚  MicroAdjustment     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                        â”‚
â”‚          â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚LearningDataRepo â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚          â”‚                        â”‚
â”‚          â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚SensitivityEngineâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
``` 

## 3. æ¸è¿›å¼å®æ–½è®¡åˆ’

å®æ–½è®¡åˆ’é‡‡ç”¨å››ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„äº¤ä»˜æˆæœå’Œä»·å€¼ï¼š

### 3.1 é˜¶æ®µä¸€ï¼šæ•°æ®åŸºç¡€è®¾æ–½ï¼ˆå·²å®Œæˆï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹æ•°æ®æ”¶é›†å’Œå­˜å‚¨åŸºç¡€ï¼Œä¸ºåç»­åˆ†ææä¾›æ•°æ®æ”¯æŒ

**å·²å®Œæˆä»»åŠ¡**ï¼š
1. è®¾è®¡å¹¶å®ç°SQLiteæ•°æ®åº“æ¶æ„
   - åˆ›å»ºäº†åŒ…è£…è®°å½•è¡¨
   - åˆ›å»ºäº†å‚æ•°è°ƒæ•´å†å²è¡¨
   - åˆ›å»ºäº†æ•æ„Ÿåº¦ç»“æœè¡¨
2. å®ç°`LearningDataRepository`ç±»
   - å®ŒæˆåŸºç¡€CRUDæ“ä½œ
   - å®ç°æ•°æ®æŸ¥è¯¢æ¥å£
   - æ·»åŠ æ‰¹é‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
   - ç»Ÿä¸€æ¥å£å‘½åè§„èŒƒï¼Œå°†`add_packaging_record`æ›´åä¸º`save_packaging_record`
3. è§£å†³äº†æµ‹è¯•ç¯å¢ƒé—®é¢˜
   - åˆ›å»ºäº†`path_setup.py`æ¨¡å—è§£å†³æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜
   - ä¿®å¤äº†æµ‹è¯•è„šæœ¬ä¸­çš„ç›¸å¯¹å¯¼å…¥è¯­æ³•é”™è¯¯
   - å®ç°äº†æ›´ç¨³å®šçš„å¯¼å…¥æœºåˆ¶ï¼Œç¡®ä¿æµ‹è¯•ç¯å¢ƒå¯é è¿è¡Œ
4. ä¼˜åŒ–äº†æ•°æ®å¯è§†åŒ–æµç¨‹
   - ä¿®å¤äº†`_plot_results`æ–¹æ³•ä¸­çš„DataFrameè®¿é—®é—®é¢˜
   - åˆ›å»ºäº†ä¸“é—¨çš„å‚æ•°åˆ—ï¼Œä¼˜åŒ–äº†å‚æ•°å¯è§†åŒ–å¤„ç†æµç¨‹
   - æ”¹è¿›äº†æ•°æ®ç»“æ„ï¼Œç¡®ä¿å‚æ•°å€¼èƒ½è¢«æ­£ç¡®è®¿é—®å’Œå±•ç¤º

**ä¸»è¦æˆæœ**ï¼š
- åŠŸèƒ½å®Œæ•´çš„æ•°æ®ä»“åº“æ¨¡å—
- ç¨³å®šå¯é çš„æµ‹è¯•ç¯å¢ƒ
- æ”¹è¿›çš„æ•°æ®å¯è§†åŒ–æœºåˆ¶
- ç»Ÿä¸€çš„æ¥å£è®¾è®¡è§„èŒƒ

**éªŒæ”¶çŠ¶æ€**ï¼šå·²å®Œæˆï¼Œç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®è®°å½•æ‰€æœ‰åŒ…è£…å‘¨æœŸæ•°æ®ï¼Œæµ‹è¯•ç¯å¢ƒç¨³å®šï¼Œå¯è§†åŒ–åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚

### 3.2 é˜¶æ®µäºŒï¼šå¾®è°ƒæ§åˆ¶å™¨ï¼ˆé¢„è®¡3å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç°åŸºäºå›ºå®šç­–ç•¥çš„å‚æ•°å¾®è°ƒæœºåˆ¶

**ä»»åŠ¡æ¸…å•**ï¼š
1. è®¾è®¡å¹¶å®ç°`AdaptiveControllerWithMicroAdjustment`ç±»
   - ç»§æ‰¿ç°æœ‰`AdaptiveController`
   - é‡å†™å‚æ•°è°ƒæ•´æ–¹æ³•
2. å®ç°é™æ€å¾®è°ƒç­–ç•¥
   - åŸºäºç›®æ ‡åå·®çš„è°ƒæ•´é€»è¾‘
   - æ·»åŠ å‚æ•°å®‰å…¨çº¦æŸ
   - å®ç°å‚æ•°éœ‡è¡æ£€æµ‹
3. æ¥å…¥å†å²æ•°æ®ä»“åº“
   - è®°å½•è°ƒæ•´è¿‡ç¨‹å’Œç»“æœ
   - è¯»å–å†å²è¡¨ç°è¯„ä¼°è°ƒæ•´æ•ˆæœ
4. æ·»åŠ æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼åˆ‡æ¢æœºåˆ¶
   - è‡ªåŠ¨æ¨¡å¼çš„å®‰å…¨é™åˆ¶
   - è°ƒæ•´è¿‡ç¨‹çš„æš‚åœ/æ¢å¤
   
**äº¤ä»˜æˆæœ**ï¼š
- åŸºäºå›ºå®šè§„åˆ™çš„å¾®è°ƒæ§åˆ¶å™¨
- å‚æ•°å®‰å…¨çº¦æŸç³»ç»Ÿ
- æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼åˆ‡æ¢åŠŸèƒ½

**éªŒæ”¶æ ‡å‡†**ï¼š
- å‚æ•°è°ƒæ•´æ›´åŠ å¹³ç¨³ï¼Œå‡å°‘éœ‡è¡
- åœ¨å„ç§ç›®æ ‡é‡é‡ä¸‹ä¿æŒç¨³å®š
- èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å¹¶é¿å…ä¸å®‰å…¨çš„å‚æ•°ç»„åˆ

### 3.3 é˜¶æ®µä¸‰ï¼šæ™ºèƒ½åˆ†æå¼•æ“ï¼ˆé¢„è®¡4å‘¨ï¼‰

**ç›®æ ‡**ï¼šå®ç°åŸºäºå†å²æ•°æ®çš„å‚æ•°æ•æ„Ÿåº¦åˆ†æå’Œç‰©æ–™ç‰¹æ€§è¯†åˆ«

**ä»»åŠ¡æ¸…å•**ï¼š
1. è®¾è®¡å¹¶å®ç°`SensitivityAnalysisEngine`ç±»
   - å•å‚æ•°æ•æ„Ÿåº¦è®¡ç®—
   - å¤šå‚æ•°äº¤äº’æ•ˆåº”åˆ†æ
   - æ ¹æ®ç›®æ ‡é‡é‡è°ƒæ•´æ•æ„Ÿåº¦æ¨¡å‹
2. å®ç°`MaterialCharacteristicsRecognizer`ç±»
   - ç‰©æ–™è¡Œä¸ºæ¨¡å¼åˆ†æ
   - ç‰¹å¾æå–å’Œåˆ†ç±»
   - ææ–™ç±»å‹æ¨èç³»ç»Ÿ
3. å¢å¼ºå¾®è°ƒæ§åˆ¶å™¨
   - é›†æˆæ•æ„Ÿåº¦åˆ†æç»“æœ
   - é›†æˆç‰©æ–™ç‰¹æ€§è¯†åˆ«
   - åŠ¨æ€è°ƒæ•´ç­–ç•¥é€‰æ‹©
4. å®ç°æ‰¹é‡åˆ†æå·¥å…·
   - å®šæœŸæ•æ„Ÿåº¦åˆ†æ
   - ç»“æœç¼“å­˜å’Œæ›´æ–°æœºåˆ¶
   
**äº¤ä»˜æˆæœ**ï¼š
- å‚æ•°æ•æ„Ÿåº¦åˆ†æå¼•æ“
- ç‰©æ–™ç‰¹æ€§è¯†åˆ«ç³»ç»Ÿ
- åŸºäºæ•æ„Ÿåº¦å’Œç‰©æ–™ç‰¹æ€§çš„æ™ºèƒ½è°ƒæ•´ç­–ç•¥

**éªŒæ”¶æ ‡å‡†**ï¼š
- ç³»ç»Ÿèƒ½å¤Ÿè®¡ç®—å‡ºä¸åŒå‚æ•°çš„æ•æ„Ÿåº¦
- èƒ½å¤Ÿè¯†åˆ«å¸¸è§ç‰©æ–™ç±»å‹çš„ç‰¹æ€§
- åŸºäºåˆ†æç»“æœè¿›è¡Œæ›´ç²¾ç¡®çš„å‚æ•°è°ƒæ•´

### 3.4 é˜¶æ®µå››ï¼šå¯è§†åŒ–ä¸ç”¨æˆ·äº¤äº’ï¼ˆé¢„è®¡3å‘¨ï¼‰

**ç›®æ ‡**ï¼šæä¾›å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–å’Œç”¨æˆ·äº¤äº’ç•Œé¢

**ä»»åŠ¡æ¸…å•**ï¼š
1. æ‰©å±•`SmartProductionTab`ç•Œé¢
   - å­¦ä¹ çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ
   - æ•æ„Ÿåº¦æŠ¥è¡¨åŒºåŸŸ
   - å‚æ•°æ¨èæ§ä»¶
2. å®ç°å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–
   - å‚æ•°å˜åŒ–è¶‹åŠ¿å›¾
   - é‡é‡è¯¯å·®è¶‹åŠ¿å›¾
   - æ•æ„Ÿåº¦çƒ­åŠ›å›¾
3. å®ç°å‚æ•°æ¨èç³»ç»Ÿ
   - åŸºäºç‰©æ–™ç±»å‹çš„æ¨è
   - åŸºäºå†å²è¡¨ç°çš„æ¨è
   - æ¨èç½®ä¿¡åº¦æŒ‡ç¤º
4. æ·»åŠ é«˜çº§äº¤äº’åŠŸèƒ½
   - æ•æ„Ÿåº¦åˆ†ææ§åˆ¶
   - ç‰©æ–™ç±»å‹æ‰‹åŠ¨æŒ‡å®š
   - å­¦ä¹ ç»“æœå¯¼å‡º
   
**äº¤ä»˜æˆæœ**ï¼š
- å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–ç•Œé¢
- å‚æ•°æ¨èç³»ç»Ÿ
- ç”¨æˆ·äº¤äº’æ§åˆ¶é¢æ¿

**éªŒæ”¶æ ‡å‡†**ï¼š
- ç•Œé¢ç›´è§‚æ˜¾ç¤ºå­¦ä¹ è¿›åº¦å’Œç»“æœ
- å‚æ•°æ¨èåŠŸèƒ½å‡†ç¡®å¯é 
- ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æ§åˆ¶å­¦ä¹ è¿‡ç¨‹

## 4. è¯¦ç»†æ¨¡å—è®¾è®¡

### 4.1 æ•°æ®å­˜å‚¨å±‚

#### 4.1.1 æ•°æ®åº“æ¶æ„

```sql
-- åŒ…è£…è®°å½•è¡¨
CREATE TABLE PackagingRecords (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp TEXT NOT NULL,
    target_weight REAL NOT NULL,
    actual_weight REAL NOT NULL,
    deviation REAL NOT NULL,
    packaging_time REAL NOT NULL,
    material_type TEXT,
    notes TEXT
);

-- å‚æ•°è®°å½•è¡¨
CREATE TABLE ParameterRecords (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    record_id INTEGER NOT NULL,
    parameter_name TEXT NOT NULL,
    parameter_value REAL NOT NULL,
    FOREIGN KEY (record_id) REFERENCES PackagingRecords(id)
);

-- å‚æ•°è°ƒæ•´å†å²è¡¨
CREATE TABLE ParameterAdjustments (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp TEXT NOT NULL,
    parameter_name TEXT NOT NULL,
    old_value REAL NOT NULL,
    new_value REAL NOT NULL,
    reason TEXT,
    record_id INTEGER,
    FOREIGN KEY (record_id) REFERENCES PackagingRecords(id)
);

-- æ•æ„Ÿåº¦åˆ†æç»“æœè¡¨
CREATE TABLE SensitivityResults (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp TEXT NOT NULL,
    parameter_name TEXT NOT NULL,
    target_weight REAL NOT NULL,
    sensitivity_value REAL NOT NULL,
    confidence REAL NOT NULL,
    sample_size INTEGER NOT NULL
);

-- ç‰©æ–™ç‰¹æ€§è¡¨
CREATE TABLE MaterialCharacteristics (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    material_type TEXT NOT NULL,
    density_estimate REAL,
    flow_characteristic TEXT,
    optimal_fast_add REAL,
    optimal_slow_add REAL,
    notes TEXT
);
```

#### 4.1.2 LearningDataRepository ç±»è®¾è®¡

```python
class LearningDataRepository:
    """æ•°æ®å­˜å‚¨å’Œè®¿é—®çš„æ ¸å¿ƒç±»"""
    
    def __init__(self, db_path='learning_data.db'):
        """åˆå§‹åŒ–æ•°æ®ä»“åº“"""
        self.db_path = db_path
        self._ensure_db_exists()
    
    def _ensure_db_exists(self):
        """ç¡®ä¿æ•°æ®åº“å­˜åœ¨å¹¶æœ‰æ­£ç¡®çš„æ¶æ„"""
        # å®ç°æ•°æ®åº“åˆå§‹åŒ–é€»è¾‘
    
    def save_packaging_record(self, target_weight, actual_weight, 
                             packaging_time, parameters, material_type=None):
        """ä¿å­˜åŒ…è£…è®°å½•å’Œç›¸å…³å‚æ•°"""
        # å®ç°äº‹åŠ¡å®‰å…¨çš„æ•°æ®ä¿å­˜
        
    def save_parameter_adjustment(self, parameter_name, old_value, 
                                 new_value, reason=None, related_record_id=None):
        """è®°å½•å‚æ•°è°ƒæ•´å†å²"""
        # å®ç°å‚æ•°è°ƒæ•´çš„è®°å½•
    
    def save_sensitivity_result(self, parameter_name, target_weight, 
                               sensitivity, confidence, sample_size):
        """ä¿å­˜æ•æ„Ÿåº¦åˆ†æç»“æœ"""
        # å®ç°æ•æ„Ÿåº¦ç»“æœä¿å­˜
        
    def get_recent_records(self, limit=100, target_weight=None):
        """è·å–æœ€è¿‘çš„åŒ…è£…è®°å½•"""
        # å®ç°è®°å½•æŸ¥è¯¢
        
    def get_parameter_history(self, parameter_name, 
                             time_range=None, limit=100):
        """è·å–å‚æ•°å†å²å˜åŒ–"""
        # å®ç°å‚æ•°å†å²æŸ¥è¯¢
        
    def get_sensitivity_for_parameter(self, parameter_name, 
                                     target_weight=None):
        """è·å–å‚æ•°çš„æ•æ„Ÿåº¦æ•°æ®"""
        # å®ç°æ•æ„Ÿåº¦æŸ¥è¯¢
        
    def calculate_statistics(self, parameter_name=None, 
                            target_weight=None, time_range=None):
        """è®¡ç®—ç»Ÿè®¡æ•°æ®"""
        # å®ç°ç»Ÿè®¡è®¡ç®—
        
    def export_data(self, start_time, end_time, format='csv'):
        """å¯¼å‡ºæ•°æ®"""
        # å®ç°æ•°æ®å¯¼å‡º
        
    def backup_database(self, backup_path=None):
        """å¤‡ä»½æ•°æ®åº“"""
        # å®ç°æ•°æ®åº“å¤‡ä»½
```

### 4.2 ç®—æ³•æ§åˆ¶å±‚

#### 4.2.1 AdaptiveControllerWithMicroAdjustment ç±»è®¾è®¡

```python
class AdaptiveControllerWithMicroAdjustment(AdaptiveController):
    """å¢å¼ºç‰ˆè‡ªé€‚åº”æ§åˆ¶å™¨ï¼Œæ·»åŠ å¾®è°ƒç­–ç•¥"""
    
    def __init__(self, data_repo=None, *args, **kwargs):
        """åˆå§‹åŒ–æ§åˆ¶å™¨"""
        super().__init__(*args, **kwargs)
        self.data_repo = data_repo or LearningDataRepository()
        self.auto_adjust_enabled = False
        self.safety_constraints = self._init_safety_constraints()
        self.adjustment_cooldown = 0
        
    def _init_safety_constraints(self):
        """åˆå§‹åŒ–å®‰å…¨çº¦æŸ"""
        return {
            'coarse_stage.advance': {'min': 100, 'max': 300, 'max_step': 10},
            'coarse_stage.speed': {'min': 50, 'max': 100, 'max_step': 5},
            'fine_stage.advance': {'min': 10, 'max': 50, 'max_step': 5},
            'fine_stage.speed': {'min': 10, 'max': 50, 'max_step': 2},
            'jog_stage.advance': {'min': 1, 'max': 10, 'max_step': 1},
            'jog_stage.speed': {'min': 5, 'max': 20, 'max_step': 1}
        }
    
    def adjust_parameters(self, target_weight, actual_weight, 
                         packaging_time, current_params):
        """é‡å†™å‚æ•°è°ƒæ•´æ–¹æ³•ï¼Œæ·»åŠ å¾®è°ƒå’Œå®‰å…¨é™åˆ¶"""
        if not self.auto_adjust_enabled:
            return current_params
            
        if self.adjustment_cooldown > 0:
            self.adjustment_cooldown -= 1
            return current_params
            
        # è®¡ç®—è¯¯å·®
        error = actual_weight - target_weight
        
        # è®°å½•åŸå§‹å‚æ•°ç”¨äºå†å²è®°å½•
        original_params = current_params.copy()
        
        # åº”ç”¨å¾®è°ƒç­–ç•¥
        adjusted_params = self._apply_micro_adjustments(
            current_params, error, target_weight)
            
        # åº”ç”¨å®‰å…¨çº¦æŸ
        safe_params = self._apply_safety_constraints(
            original_params, adjusted_params)
            
        # æ£€æµ‹å¹¶å¤„ç†éœ‡è¡
        if self._detect_oscillation(parameter_name, original_params, safe_params):
            self.adjustment_cooldown = 3  # è®¾ç½®å†·å´æœŸ
            return original_params
            
        # è®°å½•å‚æ•°è°ƒæ•´
        for param_name, new_value in safe_params.items():
            if abs(new_value - original_params.get(param_name, 0)) > 0.001:
                self.data_repo.save_parameter_adjustment(
                    param_name, original_params.get(param_name, 0), 
                    new_value, f"Error correction: {error:.2f}g")
        
        return safe_params
        
    def _apply_micro_adjustments(self, current_params, error, target_weight):
        """åº”ç”¨å¾®è°ƒç­–ç•¥"""
        # å®ç°åŸºäºè¯¯å·®çš„å¾®è°ƒé€»è¾‘
        
    def _apply_safety_constraints(self, original_params, adjusted_params):
        """åº”ç”¨å®‰å…¨çº¦æŸç¡®ä¿å‚æ•°åœ¨åˆç†èŒƒå›´å†…"""
        # å®ç°å®‰å…¨çº¦æŸæ£€æŸ¥
        
    def _detect_oscillation(self, param_name, original_params, adjusted_params):
        """æ£€æµ‹å‚æ•°æ˜¯å¦å¤„äºéœ‡è¡çŠ¶æ€"""
        # å®ç°éœ‡è¡æ£€æµ‹
        
    def enable_auto_adjust(self, enabled=True):
        """å¯ç”¨æˆ–ç¦ç”¨è‡ªåŠ¨è°ƒæ•´"""
        self.auto_adjust_enabled = enabled
        
    def set_safety_constraint(self, param_name, min_value=None, 
                             max_value=None, max_step=None):
        """è®¾ç½®ç‰¹å®šå‚æ•°çš„å®‰å…¨çº¦æŸ"""
        # å®ç°å®‰å…¨çº¦æŸè®¾ç½®
        
    def get_adjustment_history(self, param_name=None, limit=20):
        """è·å–å‚æ•°è°ƒæ•´å†å²"""
        # è°ƒç”¨æ•°æ®ä»“åº“è·å–å†å²
```

#### 4.2.2 SensitivityAnalysisEngine ç±»è®¾è®¡

```python
class SensitivityAnalysisEngine:
    """å‚æ•°æ•æ„Ÿåº¦åˆ†æå¼•æ“"""
    
    def __init__(self, data_repo):
        """åˆå§‹åŒ–æ•æ„Ÿåº¦åˆ†æå¼•æ“"""
        self.data_repo = data_repo
        
    def calculate_parameter_sensitivity(self, parameter_name, 
                                       target_weight=None, time_range=None):
        """è®¡ç®—å‚æ•°æ•æ„Ÿåº¦"""
        # è·å–ç›¸å…³æ•°æ®
        records = self.data_repo.get_parameter_history(
            parameter_name, time_range=time_range)
            
        # åˆ†ç»„åˆ†æ
        grouped_data = self._group_data_by_parameter_value(
            records, parameter_name, target_weight)
            
        # è®¡ç®—æ•æ„Ÿåº¦
        sensitivity, confidence, sample_size = self._compute_sensitivity(grouped_data)
        
        # ä¿å­˜ç»“æœ
        if sensitivity is not None:
            self.data_repo.save_sensitivity_result(
                parameter_name, target_weight or 0, 
                sensitivity, confidence, sample_size)
            
        return {
            'parameter': parameter_name,
            'target_weight': target_weight,
            'sensitivity': sensitivity,
            'confidence': confidence,
            'sample_size': sample_size
        }
        
    def _group_data_by_parameter_value(self, records, parameter_name, target_weight):
        """å°†æ•°æ®æŒ‰å‚æ•°å€¼åˆ†ç»„"""
        # å®ç°æ•°æ®åˆ†ç»„é€»è¾‘
        
    def _compute_sensitivity(self, grouped_data):
        """è®¡ç®—æ•æ„Ÿåº¦å’Œç½®ä¿¡åº¦"""
        # å®ç°æ•æ„Ÿåº¦è®¡ç®—ç®—æ³•
        
    def calculate_all_parameters_sensitivity(self, target_weight=None):
        """è®¡ç®—æ‰€æœ‰å‚æ•°çš„æ•æ„Ÿåº¦"""
        # è·å–æ‰€æœ‰å‚æ•°åç§°
        all_params = self._get_all_parameter_names()
        
        results = {}
        for param in all_params:
            result = self.calculate_parameter_sensitivity(
                param, target_weight=target_weight)
            results[param] = result
            
        return results
        
    def _get_all_parameter_names(self):
        """è·å–æ‰€æœ‰å‚æ•°åç§°"""
        # å®ç°å‚æ•°åç§°è·å–
        
    def get_most_sensitive_parameters(self, target_weight=None, top_n=3):
        """è·å–æœ€æ•æ„Ÿçš„å‰Nä¸ªå‚æ•°"""
        # å®ç°æ•æ„Ÿåº¦æ’åºå’Œé€‰æ‹©
        
    def estimate_parameter_impact(self, parameter_name, 
                                 value_change, target_weight=None):
        """ä¼°è®¡å‚æ•°å˜åŒ–çš„å½±å“"""
        # å®ç°å½±å“é¢„æµ‹
```

#### 4.2.3 MaterialCharacteristicsRecognizer ç±»è®¾è®¡

```python
class MaterialCharacteristicsRecognizer:
    """ç‰©æ–™ç‰¹æ€§è¯†åˆ«å™¨"""
    
    def __init__(self, data_repo):
        """åˆå§‹åŒ–ç‰©æ–™ç‰¹æ€§è¯†åˆ«å™¨"""
        self.data_repo = data_repo
        self.known_materials = self._load_known_materials()
        
    def _load_known_materials(self):
        """åŠ è½½å·²çŸ¥ç‰©æ–™ç‰¹æ€§"""
        # ä»æ•°æ®åº“åŠ è½½å·²çŸ¥ç‰©æ–™ä¿¡æ¯
        
    def analyze_material_behavior(self, recent_records_count=20):
        """åˆ†ææœ€è¿‘åŒ…è£…è®°å½•è¯†åˆ«ç‰©æ–™è¡Œä¸ºç‰¹å¾"""
        # è·å–æœ€è¿‘è®°å½•
        records = self.data_repo.get_recent_records(limit=recent_records_count)
        
        # æå–ç‰¹å¾
        features = self._extract_material_features(records)
        
        # åˆ†ç±»åŒ¹é…
        material_type, confidence = self._classify_material(features)
        
        return {
            'material_type': material_type,
            'confidence': confidence,
            'features': features
        }
        
    def _extract_material_features(self, records):
        """ä»è®°å½•ä¸­æå–ç‰©æ–™ç‰¹å¾"""
        # å®ç°ç‰¹å¾æå–ç®—æ³•
        
    def _classify_material(self, features):
        """åŸºäºç‰¹å¾åˆ†ç±»ç‰©æ–™ç±»å‹"""
        # å®ç°åˆ†ç±»ç®—æ³•
        
    def recommend_parameters_for_material(self, material_type):
        """åŸºäºç‰©æ–™ç±»å‹æ¨èå‚æ•°è®¾ç½®"""
        # æŸ¥æ‰¾ç‰©æ–™çš„æœ€ä½³å‚æ•°
        material = self._find_material(material_type)
        
        if not material:
            return None
            
        return {
            'coarse_stage.advance': material.get('optimal_fast_add'),
            'fine_stage.advance': material.get('optimal_slow_add'),
            # å…¶ä»–å‚æ•°...
        }
        
    def _find_material(self, material_type):
        """æŸ¥æ‰¾ç‰¹å®šç‰©æ–™ç±»å‹çš„æ•°æ®"""
        # å®ç°ç‰©æ–™æŸ¥æ‰¾
        
    def register_new_material(self, material_type, characteristics):
        """æ³¨å†Œæ–°ç‰©æ–™ç±»å‹åŠå…¶ç‰¹æ€§"""
        # å®ç°æ–°ç‰©æ–™æ³¨å†Œ
```

### 4.3 ç”¨æˆ·ç•Œé¢å±‚

#### 4.3.1 å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–ç»„ä»¶è®¾è®¡

```python
class LearningVisualizationFrame(tk.Frame):
    """å­¦ä¹ è¿‡ç¨‹å¯è§†åŒ–ç»„ä»¶"""
    
    def __init__(self, master, data_repo, *args, **kwargs):
        """åˆå§‹åŒ–å¯è§†åŒ–ç»„ä»¶"""
        super().__init__(master, *args, **kwargs)
        self.data_repo = data_repo
        self.figure = None
        self.canvas = None
        self._init_ui()
        
    def _init_ui(self):
        """åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢"""
        # åˆ›å»ºå›¾è¡¨åŒºåŸŸ
        self.figure = Figure(figsize=(8, 4), dpi=100)
        self.canvas = FigureCanvasTkAgg(self.figure, self)
        self.canvas.get_tk_widget().pack(fill=tk.BOTH, expand=True)
        
        # åˆ›å»ºæ§åˆ¶åŒºåŸŸ
        controls_frame = tk.Frame(self)
        controls_frame.pack(fill=tk.X)
        
        # æ·»åŠ å‚æ•°é€‰æ‹©ä¸‹æ‹‰æ¡†
        self.param_var = tk.StringVar()
        ttk.Label(controls_frame, text="å‚æ•°:").pack(side=tk.LEFT)
        self.param_combo = ttk.Combobox(
            controls_frame, textvariable=self.param_var)
        self.param_combo.pack(side=tk.LEFT, padx=5)
        self.param_combo.bind("<<ComboboxSelected>>", self.update_visualization)
        
        # æ·»åŠ æ—¶é—´èŒƒå›´é€‰æ‹©
        self.time_range_var = tk.StringVar(value="Last 50")
        ttk.Label(controls_frame, text="æ—¶é—´èŒƒå›´:").pack(side=tk.LEFT, padx=(20, 0))
        time_combo = ttk.Combobox(
            controls_frame, textvariable=self.time_range_var,
            values=["Last 20", "Last 50", "Last 100", "All"])
        time_combo.pack(side=tk.LEFT, padx=5)
        time_combo.bind("<<ComboboxSelected>>", self.update_visualization)
        
        # æ·»åŠ æ›´æ–°æŒ‰é’®
        ttk.Button(
            controls_frame, text="åˆ·æ–°", command=self.update_visualization
        ).pack(side=tk.RIGHT, padx=5)
        
        # åˆå§‹åŒ–å‚æ•°åˆ—è¡¨
        self._update_parameter_list()
        
    def _update_parameter_list(self):
        """æ›´æ–°å‚æ•°åˆ—è¡¨"""
        # ä»æ•°æ®ä»“åº“è·å–å‚æ•°åˆ—è¡¨
        
    def update_visualization(self, event=None):
        """æ›´æ–°å¯è§†åŒ–å›¾è¡¨"""
        param = self.param_var.get()
        time_range = self.time_range_var.get()
        
        if not param:
            return
            
        # è·å–æ•°æ®
        data = self._get_visualization_data(param, time_range)
        
        # æ¸…é™¤æ—§å›¾è¡¨
        self.figure.clear()
        
        # åˆ›å»ºæ–°å›¾è¡¨
        self._create_parameter_trend_chart(data)
        self._create_weight_error_chart(data)
        
        # æ›´æ–°ç”»å¸ƒ
        self.canvas.draw()
        
    def _get_visualization_data(self, param, time_range):
        """è·å–å¯è§†åŒ–æ‰€éœ€æ•°æ®"""
        # å®ç°æ•°æ®è·å–é€»è¾‘
        
    def _create_parameter_trend_chart(self, data):
        """åˆ›å»ºå‚æ•°è¶‹åŠ¿å›¾"""
        # å®ç°å‚æ•°å˜åŒ–è¶‹åŠ¿å›¾
        
    def _create_weight_error_chart(self, data):
        """åˆ›å»ºé‡é‡è¯¯å·®å›¾"""
        # å®ç°é‡é‡è¯¯å·®è¶‹åŠ¿å›¾
```

#### 4.3.2 å‚æ•°æ¨èç³»ç»Ÿè®¾è®¡

```python
class ParameterRecommendationSystem:
    """å‚æ•°æ¨èç³»ç»Ÿ"""
    
    def __init__(self, data_repo, sensitivity_engine, material_recognizer):
        """åˆå§‹åŒ–æ¨èç³»ç»Ÿ"""
        self.data_repo = data_repo
        self.sensitivity_engine = sensitivity_engine
        self.material_recognizer = material_recognizer
        
    def get_recommendations(self, target_weight, current_parameters):
        """è·å–å‚æ•°æ¨è"""
        # è¯†åˆ«ç‰©æ–™ç‰¹æ€§
        material_analysis = self.material_recognizer.analyze_material_behavior()
        material_type = material_analysis['material_type']
        material_confidence = material_analysis['confidence']
        
        # è·å–æ•æ„Ÿåº¦æ•°æ®
        sensitivity_data = self.sensitivity_engine.get_most_sensitive_parameters(
            target_weight=target_weight)
            
        # è·å–åŸºäºç‰©æ–™çš„æ¨è
        material_recommendations = {}
        if material_type and material_confidence > 0.7:
            material_recommendations = self.material_recognizer.recommend_parameters_for_material(
                material_type)
                
        # ç»“åˆå½“å‰å‚æ•°ã€æ•æ„Ÿåº¦å’Œç‰©æ–™æ¨èç”Ÿæˆæœ€ç»ˆæ¨è
        recommendations = {}
        confidence_levels = {}
        
        for param_name, current_value in current_parameters.items():
            # åŸºäºæ•æ„Ÿåº¦çš„å¾®è°ƒ
            sensitivity_info = next(
                (s for s in sensitivity_data if s['parameter'] == param_name), None)
                
            # åŸºäºç‰©æ–™çš„æ¨èå€¼
            material_value = material_recommendations.get(param_name)
            
            # ç”Ÿæˆæœ€ç»ˆæ¨è
            if sensitivity_info and sensitivity_info['confidence'] > 0.6:
                # ä½¿ç”¨æ•æ„Ÿåº¦ä¿¡æ¯ä¼˜åŒ–
                recommended_value = self._optimize_with_sensitivity(
                    current_value, sensitivity_info, target_weight)
                confidence = sensitivity_info['confidence']
            elif material_value is not None:
                # ä½¿ç”¨ç‰©æ–™æ¨è
                recommended_value = material_value
                confidence = material_confidence
            else:
                # ä¿æŒå½“å‰å€¼
                recommended_value = current_value
                confidence = 0.5
                
            recommendations[param_name] = recommended_value
            confidence_levels[param_name] = confidence
            
        return {
            'recommendations': recommendations,
            'confidence_levels': confidence_levels,
            'material_type': material_type,
            'material_confidence': material_confidence
        }
        
    def _optimize_with_sensitivity(self, current_value, sensitivity_info, target_weight):
        """ä½¿ç”¨æ•æ„Ÿåº¦ä¿¡æ¯ä¼˜åŒ–å‚æ•°å€¼"""
        # å®ç°åŸºäºæ•æ„Ÿåº¦çš„ä¼˜åŒ–ç®—æ³•
```

## 5. é£é™©ç®¡ç†

### 5.1 é£é™©è¯†åˆ«ä¸è¯„ä¼°

| é£é™©ç±»åˆ« | é£é™©æè¿° | å¯èƒ½æ€§ | å½±å“ | ä¸¥é‡åº¦ | ç¼“è§£ç­–ç•¥ | çŠ¶æ€ |
|----------|----------|--------|------|--------|----------|------|
| æŠ€æœ¯é£é™© | æ•°æ®åº“æ€§èƒ½é—®é¢˜å½±å“ç³»ç»Ÿå“åº” | ä¸­ | ä¸­ | ä¸­ | å¼‚æ­¥æ“ä½œï¼Œæ‰¹é‡å¤„ç†ï¼Œæ€§èƒ½ç›‘æ§ | ç›‘æ§ä¸­ |
| æŠ€æœ¯é£é™© | å‚æ•°æ•æ„Ÿåº¦åˆ†æä¸å‡†ç¡®å¯¼è‡´é”™è¯¯è°ƒæ•´ | ä¸­ | é«˜ | é«˜ | é™åˆ¶åˆå§‹è°ƒæ•´å¹…åº¦ï¼Œç½®ä¿¡åº¦é˜ˆå€¼ | è§„åˆ’ä¸­ |
| æŠ€æœ¯é£é™© | å¾®è°ƒç®—æ³•å¼•å…¥å‚æ•°éœ‡è¡ | ä¸­ | é«˜ | é«˜ | éœ‡è¡æ£€æµ‹ï¼Œå†·å´æœŸï¼Œäººå·¥ç¡®è®¤ | è§„åˆ’ä¸­ |
| æŠ€æœ¯é£é™© | SQLiteå¹¶å‘è®¿é—®é—®é¢˜ | ä½ | ä¸­ | ä½ | äº‹åŠ¡ç®¡ç†ï¼Œè®¿é—®æ¨¡å¼ä¼˜åŒ– | å·²è§£å†³ |
| æŠ€æœ¯é£é™© | æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜å½±å“æµ‹è¯•ç¯å¢ƒ | ä¸­ | ä¸­ | ä¸­ | ç»Ÿä¸€è·¯å¾„ç®¡ç†æ¨¡å—ï¼Œæ ‡å‡†åŒ–å¯¼å…¥è·¯å¾„ | å·²è§£å†³ |
| æŠ€æœ¯é£é™© | æ¥å£ä¸ä¸€è‡´å¯¼è‡´åŠŸèƒ½å¤±æ•ˆ | é«˜ | é«˜ | é«˜ | æ¥å£ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | éƒ¨åˆ†è§£å†³ |
| æŠ€æœ¯é£é™© | æ•°æ®å¯è§†åŒ–ç»“æ„è®¿é—®é”™è¯¯ | ä¸­ | ä¸­ | ä¸­ | æ•°æ®ç»“æ„æ ‡å‡†åŒ–ï¼Œå¢å¼ºæ•°æ®å¤„ç†å¥å£®æ€§ | å·²è§£å†³ |
| é¡¹ç›®é£é™© | æ–°åŠŸèƒ½ä¸ç°æœ‰ç³»ç»Ÿé›†æˆé—®é¢˜ | ä¸­ | é«˜ | é«˜ | æ¾è€¦åˆè®¾è®¡ï¼Œæ¸è¿›å¼é›†æˆï¼Œå•å…ƒæµ‹è¯• | ç›‘æ§ä¸­ |
| é¡¹ç›®é£é™© | ç³»ç»Ÿå¤æ‚åº¦å¢åŠ å¯¼è‡´ç»´æŠ¤å›°éš¾ | é«˜ | ä¸­ | é«˜ | æ¨¡å—åŒ–è®¾è®¡ï¼Œè¯¦ç»†æ–‡æ¡£ï¼Œä»£ç å®¡æŸ¥ | è¿›è¡Œä¸­ |
| ä¸šåŠ¡é£é™© | è‡ªå­¦ä¹ æ•ˆæœä¸å¦‚é¢„æœŸ | ä¸­ | é«˜ | é«˜ | æ‰‹åŠ¨æ¨¡å¼å›é€€ï¼Œå¯é…ç½®å­¦ä¹ ç‡ | è§„åˆ’ä¸­ |
| ä¸šåŠ¡é£é™© | ç”¨æˆ·æ¥å—åº¦ä½ | ä¸­ | é«˜ | ä¸­ | å¢å¼ºç”¨æˆ·åŸ¹è®­ï¼Œé»˜è®¤ç®€å•ç•Œé¢ | è§„åˆ’ä¸­ |

### 5.2 é£é™©ç¼“è§£è®¡åˆ’

#### 5.2.1 æŠ€æœ¯é£é™©ç¼“è§£

1. **æ•°æ®åº“æ€§èƒ½é—®é¢˜**
   - å®ç°å¼‚æ­¥æ•°æ®å†™å…¥
   - æ‰¹é‡å¤„ç†å¤§é‡æ•°æ®æ“ä½œ
   - å®šæœŸæ¸…ç†å’Œä¼˜åŒ–æ•°æ®åº“
   - æ€§èƒ½ç›‘æ§å’Œè‡ªåŠ¨è­¦æŠ¥

2. **å‚æ•°æ•æ„Ÿåº¦åˆ†æä¸å‡†ç¡®**
   - åˆå§‹é˜¶æ®µä½¿ç”¨ä¿å®ˆè°ƒæ•´ç³»æ•°
   - å®ç°ç½®ä¿¡åº¦è¯„ä¼°å’Œé˜ˆå€¼
   - å¤šç§ç®—æ³•äº¤å‰éªŒè¯
   - å¼‚å¸¸å€¼æ£€æµ‹å’Œè¿‡æ»¤

3. **å‚æ•°éœ‡è¡é—®é¢˜**
   - å®ç°éœ‡è¡æ£€æµ‹ç®—æ³•
   - å®æ–½å†·å´æœŸæœºåˆ¶
   - å‚æ•°è°ƒæ•´ä¸Šé™æ§åˆ¶
   - è¶‹åŠ¿åˆ†æé¿å…åå‘è°ƒæ•´

4. **å¹¶å‘è®¿é—®é—®é¢˜**
   - åˆç†è®¾è®¡äº‹åŠ¡è¾¹ç•Œ
   - å®ç°æ•°æ®è®¿é—®é˜Ÿåˆ—
   - è¯»å†™æ“ä½œåˆ†ç¦»
   - é”™è¯¯é‡è¯•æœºåˆ¶

5. **æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜** (å·²è§£å†³)
   - åˆ›å»ºäº†ç»Ÿä¸€çš„`path_setup.py`æ¨¡å—ç®¡ç†å¯¼å…¥è·¯å¾„
   - å®ç°äº†ç¨³å®šçš„å¯¼å…¥æœºåˆ¶ï¼Œç¡®ä¿æµ‹è¯•ç¯å¢ƒå¯é è¿è¡Œ
   - è§£å†³äº†è·¨ç›®å½•è®¿é—®æ¨¡å—çš„æŠ€æœ¯æŒ‘æˆ˜
   - æ·»åŠ äº†è¯¦ç»†çš„å¯¼å…¥è·¯å¾„ä½¿ç”¨è¯´æ˜

6. **æ¥å£ä¸ä¸€è‡´é—®é¢˜** (éƒ¨åˆ†è§£å†³)
   - ç»Ÿä¸€äº†æ¥å£å‘½åè§„èŒƒï¼Œå°†`add_packaging_record`æ›´åä¸º`save_packaging_record`
   - ä¿®å¤äº†`analyze_recent_performance`æ–¹æ³•çš„å‚æ•°ç­›é€‰é€»è¾‘
   - æ›´æ–°äº†.clinerulesæ–‡ä»¶ï¼Œè®°å½•æ¥å£è®¾è®¡è§„èŒƒ
   - è®¡åˆ’å®æ–½æ¥å£ä¸€è‡´æ€§æ£€æŸ¥å·¥å…·

7. **æ•°æ®å¯è§†åŒ–é—®é¢˜** (å·²è§£å†³)
   - ä¿®å¤äº†`_plot_results`æ–¹æ³•ä¸­çš„DataFrameè®¿é—®é—®é¢˜
   - é€šè¿‡åˆ›å»ºä¸“é—¨çš„å‚æ•°åˆ—ï¼Œä¼˜åŒ–äº†å‚æ•°å¯è§†åŒ–å¤„ç†æµç¨‹
   - æ”¹è¿›äº†æ•°æ®ç»“æ„ï¼Œç¡®ä¿å‚æ•°å€¼èƒ½è¢«æ­£ç¡®è®¿é—®å’Œå±•ç¤º
   - å¢å¼ºäº†å›¾è¡¨ç”Ÿæˆçš„ç¨³å®šæ€§å’Œå‡†ç¡®æ€§

#### 5.2.2 é¡¹ç›®é£é™©ç¼“è§£

1. **é›†æˆé—®é¢˜**
   - æ¾è€¦åˆè®¾è®¡
   - æ˜ç¡®çš„æ¥å£å®šä¹‰
   - å…¨é¢çš„é›†æˆæµ‹è¯•
   - å›æ»šæœºåˆ¶

2. **å¤æ‚åº¦ç®¡ç†**
   - æ¨¡å—åŒ–è®¾è®¡
   - è¯¦ç»†æ–‡æ¡£
   - ä»£ç å®¡æŸ¥
   - æ¸è¿›å¼å®æ–½

#### 5.2.3 ä¸šåŠ¡é£é™©ç¼“è§£

1. **è‡ªå­¦ä¹ æ•ˆæœé—®é¢˜**
   - æ‰‹åŠ¨å¹²é¢„é€‰é¡¹
   - å¯é…ç½®å­¦ä¹ å‚æ•°
   - A/Bæµ‹è¯•ä¸åŒç­–ç•¥
   - å®šæœŸè¯„ä¼°å’Œè°ƒæ•´

2. **ç”¨æˆ·æ¥å—åº¦**
   - ç”¨æˆ·åŸ¹è®­å’Œææ–™
   - ç®€æ˜çš„ç•Œé¢è®¾è®¡
   - æ¸è¿›å¼åŠŸèƒ½å¼•å…¥
   - ç”¨æˆ·åé¦ˆæ”¶é›†å’Œå“åº”

## 6. æµ‹è¯•ç­–ç•¥

### 6.1 æµ‹è¯•åˆ†ç±»

1. **å•å…ƒæµ‹è¯•**
   - å¯¹å„ä¸ªç±»å’Œæ–¹æ³•çš„åŠŸèƒ½æµ‹è¯•
   - é‡ç‚¹æµ‹è¯•ç®—æ³•é€»è¾‘å’Œæ•°æ®å¤„ç†
   - æµ‹è¯•æ¡†æ¶: pytest
   - ç›®æ ‡è¦†ç›–ç‡: >80%

2. **é›†æˆæµ‹è¯•**
   - æµ‹è¯•æ¨¡å—é—´åä½œ
   - æ•°æ®æµå’Œæ¥å£æµ‹è¯•
   - ç‰¹åˆ«å…³æ³¨æ–°æ—§ç³»ç»Ÿé›†æˆç‚¹
   - åŒ…å«UIä¸é€»è¾‘å±‚é›†æˆ

3. **æ€§èƒ½æµ‹è¯•**
   - æ•°æ®åº“æ“ä½œæ€§èƒ½
   - å¤§é‡æ•°æ®å¤„ç†æ€§èƒ½
   - é•¿æ—¶é—´è¿è¡Œç¨³å®šæ€§
   - å†…å­˜æ³„æ¼æ£€æµ‹

4. **ç”¨æˆ·éªŒæ”¶æµ‹è¯•**
   - å®é™…æ“ä½œåœºæ™¯æµ‹è¯•
   - ä¸åŒç‰©æ–™å’Œç›®æ ‡é‡é‡æµ‹è¯•
   - ç”¨æˆ·ç•Œé¢æ˜“ç”¨æ€§æµ‹è¯•
   - å¼‚å¸¸å¤„ç†å’Œæ¢å¤æµ‹è¯•

### 6.2 æµ‹è¯•ç¯å¢ƒ

1. **å¼€å‘ç¯å¢ƒ**
   - ç”¨äºå•å…ƒæµ‹è¯•å’ŒåŸºæœ¬é›†æˆæµ‹è¯•
   - ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®å’Œç®€åŒ–ç¯å¢ƒ
   - å¿«é€Ÿåé¦ˆå¾ªç¯

2. **æµ‹è¯•ç¯å¢ƒ**
   - æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒé…ç½®
   - åŒ…å«å®Œæ•´æ•°æ®é›†
   - é›†æˆå’Œæ€§èƒ½æµ‹è¯•

3. **ç”Ÿäº§å‰ç¯å¢ƒ**
   - ä¸ç”Ÿäº§ç¯å¢ƒç›¸åŒé…ç½®
   - æœ€ç»ˆéªŒæ”¶æµ‹è¯•
   - ç”¨æˆ·å‚ä¸æµ‹è¯•

### 6.3 æµ‹è¯•æ•°æ®ç­–ç•¥

1. **æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ**
   - åŸºäºçœŸå®åœºæ™¯çš„å‚æ•°èŒƒå›´
   - åŒ…å«æ­£å¸¸å’Œè¾¹ç¼˜æƒ…å†µ
   - ç”Ÿæˆå·²çŸ¥è¡Œä¸ºæ¨¡å¼æ•°æ®

2. **å†å²æ•°æ®åˆ©ç”¨**
   - ä½¿ç”¨ç°æœ‰ç³»ç»Ÿçš„å†å²æ•°æ®
   - è½¬æ¢ä¸ºæ–°ç³»ç»Ÿå¯ç”¨æ ¼å¼
   - éªŒè¯æ•°æ®è¿ç§»å’Œå…¼å®¹æ€§

3. **æ··åˆæµ‹è¯•æ–¹æ³•**
   - ç»“åˆå®é™…ç‰©æ–™æµ‹è¯•
   - å‚æ•°æ•æ„Ÿåº¦ç‰¹æ®Šæµ‹è¯•åœºæ™¯
   - é•¿æœŸè¿è¡Œç¨³å®šæ€§æµ‹è¯•

## 7. éƒ¨ç½²ä¸ç»´æŠ¤è®¡åˆ’

### 7.1 éƒ¨ç½²è®¡åˆ’

1. **ç¬¬ä¸€é˜¶æ®µ: æ•°æ®æ”¶é›†éƒ¨ç½²**
   - ä»…éƒ¨ç½²æ•°æ®åº“å’Œæ•°æ®æ”¶é›†ç»„ä»¶
   - ä¸å½±å“ç°æœ‰ç³»ç»Ÿè¿è¡Œ
   - å¼€å§‹æ”¶é›†å®é™…è¿è¡Œæ•°æ®

2. **ç¬¬äºŒé˜¶æ®µ: å¾®è°ƒæ§åˆ¶å™¨éƒ¨ç½²**
   - éƒ¨ç½²å¸¦æœ‰å®‰å…¨çº¦æŸçš„å¾®è°ƒæ§åˆ¶å™¨
   - é»˜è®¤ä¸ºæ‰‹åŠ¨æ¨¡å¼
   - åœ¨å—æ§ç¯å¢ƒä¸‹æµ‹è¯•è‡ªåŠ¨æ¨¡å¼

3. **ç¬¬ä¸‰é˜¶æ®µ: åˆ†æå¼•æ“éƒ¨ç½²**
   - ä½¿ç”¨æ”¶é›†çš„æ•°æ®æ ¡å‡†åˆ†æå¼•æ“
   - åœ¨ç›‘ç£ä¸‹åº”ç”¨æ•æ„Ÿåº¦åˆ†æç»“æœ
   - éªŒè¯ç‰©æ–™è¯†åˆ«å‡†ç¡®æ€§

4. **ç¬¬å››é˜¶æ®µ: ç”¨æˆ·ç•Œé¢éƒ¨ç½²**
   - å®Œæ•´åŠŸèƒ½éƒ¨ç½²
   - ç”¨æˆ·åŸ¹è®­å’Œæ”¯æŒ
   - æŒç»­ç›‘æ§å’Œè°ƒæ•´

### 7.2 ç»´æŠ¤è®¡åˆ’

1. **æ—¥å¸¸ç»´æŠ¤**
   - æ•°æ®åº“ä¼˜åŒ–å’Œæ¸…ç†
   - æ—¥å¿—åˆ†æå’Œç›‘æ§
   - æ€§èƒ½æ£€æŸ¥

2. **å®šæœŸè¯„ä¼°**
   - æ¯å‘¨åˆ†æç³»ç»Ÿå­¦ä¹ æ•ˆæœ
   - æ¯æœˆå®¡æŸ¥å‚æ•°æ•æ„Ÿåº¦å˜åŒ–
   - å­£åº¦ç³»ç»Ÿæ€§èƒ½è¯„ä¼°

3. **æ›´æ–°ç­–ç•¥**
   - æ•æ„Ÿåº¦æ¨¡å‹å®šæœŸæ›´æ–°
   - ç‰©æ–™ç‰¹æ€§åº“æ‰©å±•
   - ç®—æ³•ä¼˜åŒ–å’Œbugä¿®å¤

## 8. æ€»ç»“å’Œåç»­è®¡åˆ’

è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿå°†é€šè¿‡æ•°æ®é©±åŠ¨çš„æ–¹æ³•å¤§å¹…æå‡ç§°é‡åŒ…è£…ç³»ç»Ÿçš„æ™ºèƒ½åŒ–æ°´å¹³ã€‚æ¸è¿›å¼å®æ–½ç­–ç•¥ç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½èƒ½æä¾›ç‹¬ç«‹ä»·å€¼ï¼ŒåŒæ—¶æœ€å°åŒ–å¯¹ç°æœ‰ç³»ç»Ÿçš„å½±å“ã€‚

### 8.1 ä¸»è¦æ”¶ç›Š

- å‡å°‘å‚æ•°è°ƒæ•´éœ‡è¡ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§
- è‡ªåŠ¨é€‚åº”ä¸åŒç‰©æ–™ç‰¹æ€§ï¼Œå‡å°‘äººå·¥å¹²é¢„
- åŸºäºå†å²æ•°æ®æŒç»­ä¼˜åŒ–ï¼Œæé«˜åŒ…è£…ç²¾åº¦
- é€æ˜çš„å­¦ä¹ è¿‡ç¨‹ï¼Œå¢å¼ºç”¨æˆ·ä¿¡ä»»å’Œç³»ç»Ÿå¯è§£é‡Šæ€§

### 8.2 é•¿æœŸå‘å±•æ–¹å‘

1. **é¢„æµ‹æ€§æ§åˆ¶**
   - åŸºäºæ›´å¤šå†å²æ•°æ®å¼€å‘é¢„æµ‹æ¨¡å‹
   - æå‰é¢„æµ‹å¹¶è°ƒæ•´å‚æ•°

2. **é«˜çº§æœºå™¨å­¦ä¹ é›†æˆ**
   - æ¢ç´¢æ›´å¤æ‚çš„å­¦ä¹ ç®—æ³•
   - å¤„ç†æ›´å¤šå˜é‡çš„äº¤äº’æ•ˆåº”

3. **è·¨è®¾å¤‡æ•°æ®å…±äº«**
   - å¤šè®¾å¤‡æ•°æ®æ±‡æ€»å’Œåˆ†æ
   - è·¨è®¾å¤‡çŸ¥è¯†è¿ç§»

### 8.3 æˆåŠŸæ ‡å‡†

1. **çŸ­æœŸæŒ‡æ ‡** (å®æ–½å1-2ä¸ªæœˆ)
   - å‚æ•°éœ‡è¡å‡å°‘50%
   - ç³»ç»Ÿç¨³å®šæ€§æé«˜30%
   - ç”¨æˆ·æ¥å—åº¦>70%

2. **ä¸­æœŸæŒ‡æ ‡** (å®æ–½å3-6ä¸ªæœˆ)
   - åŒ…è£…ç²¾åº¦æé«˜15%
   - è°ƒæ•´ç‰©æ–™æ—¶é—´å‡å°‘40%
   - äººå·¥å¹²é¢„å‡å°‘60%

3. **é•¿æœŸæŒ‡æ ‡** (å®æ–½å6-12ä¸ªæœˆ)
   - ç³»ç»Ÿå®Œå…¨è‡ªé€‚åº”ä¸åŒç‰©æ–™
   - å‚æ•°ä¼˜åŒ–æ¥è¿‘ç†è®ºæœ€ä¼˜
   - ç”¨æˆ·å®Œå…¨æ¥å—å¹¶ä¾èµ–ç³»ç»Ÿæ¨è

### 8.4 æœ€æ–°æˆæœæ€»ç»“

åœ¨é¡¹ç›®çš„åˆæœŸé˜¶æ®µï¼Œæˆ‘ä»¬å·²ç»å–å¾—äº†ä»¥ä¸‹å…³é”®æˆæœï¼š

1. **æ•°æ®å­˜å‚¨åŸºç¡€è®¾æ–½å®Œæˆ**
   - å®ç°äº†åŸºäºSQLiteçš„å­¦ä¹ æ•°æ®ä»“åº“
   - å¼€å‘äº†å®Œæ•´çš„æ•°æ®å­˜å‚¨å’Œæ£€ç´¢æ¥å£
   - æ·»åŠ äº†æ•°æ®å¯¼å‡ºå’Œå¤‡ä»½åŠŸèƒ½

2. **æµ‹è¯•ç¯å¢ƒé—®é¢˜è§£å†³**
   - åˆ›å»ºäº†`path_setup.py`æ¨¡å—è§£å†³æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜
   - ä¿®å¤äº†æµ‹è¯•è„šæœ¬ä¸­çš„ç›¸å¯¹å¯¼å…¥è¯­æ³•é”™è¯¯
   - å®ç°äº†æ›´ç¨³å®šçš„å¯¼å…¥æœºåˆ¶ï¼Œç¡®ä¿æµ‹è¯•ç¯å¢ƒå¯é è¿è¡Œ

3. **æ¥å£æ ‡å‡†åŒ–è¿›å±•**
   - ç»Ÿä¸€äº†æ¥å£å‘½åè§„èŒƒï¼Œå°†`add_packaging_record`æ›´åä¸º`save_packaging_record`
   - ä¿®å¤äº†å¤šå¤„æ–¹æ³•å‚æ•°å’Œé€»è¾‘ä¸ä¸€è‡´é—®é¢˜
   - å»ºç«‹äº†æ¥å£è®¾è®¡è§„èŒƒï¼Œè®°å½•åœ¨.clinerulesæ–‡ä»¶ä¸­

4. **æ•°æ®å¯è§†åŒ–ä¼˜åŒ–**
   - ä¿®å¤äº†`_plot_results`æ–¹æ³•ä¸­çš„DataFrameè®¿é—®é—®é¢˜
   - ä¼˜åŒ–äº†å‚æ•°å¯è§†åŒ–å¤„ç†æµç¨‹
   - æ”¹è¿›äº†æ•°æ®ç»“æ„ï¼Œç¡®ä¿å‚æ•°å€¼èƒ½è¢«æ­£ç¡®è®¿é—®å’Œå±•ç¤º

è¿™äº›æˆæœä¸ºä¸‹ä¸€é˜¶æ®µçš„å¼€å‘å¥ å®šäº†åšå®çš„åŸºç¡€ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œä»£ç è´¨é‡æ–¹é¢ã€‚æˆ‘ä»¬å°†ç»§ç»­æ¨è¿›é¡¹ç›®ï¼Œå®ç°çœŸæ­£çš„è‡ªé€‚åº”å­¦ä¹ èƒ½åŠ›ã€‚

## 9. æ¥å£è®¾è®¡è§„èŒƒ

ä¸ºç¡®ä¿ç³»ç»Ÿå„ç»„ä»¶ä¹‹é—´çš„ä¸€è‡´æ€§å’Œç¨³å®šæ€§ï¼Œæˆ‘ä»¬åˆ¶å®šäº†ä»¥ä¸‹æ¥å£è®¾è®¡è§„èŒƒï¼š

### 9.1 å‘½åçº¦å®š

1. **æ–¹æ³•å‘½å**
   - ä½¿ç”¨åŠ¨è¯å¼€å¤´çš„å‘½åçº¦å®š: get_*, set_*, save_*, update_*, delete_*, calculate_*
   - æŸ¥è¯¢æ–¹æ³•ä½¿ç”¨get_å‰ç¼€: ä¾‹å¦‚`get_recent_records`
   - ä¿å­˜æ–¹æ³•ä½¿ç”¨save_å‰ç¼€: ä¾‹å¦‚`save_packaging_record`
   - æ›´æ–°æ–¹æ³•ä½¿ç”¨update_å‰ç¼€: ä¾‹å¦‚`update_parameter`

2. **å‚æ•°å‘½å**
   - ä½¿ç”¨æè¿°æ€§åç§°: ä¾‹å¦‚`record_limit`è€Œéç®€å•çš„`limit`
   - å¸ƒå°”å‚æ•°ä½¿ç”¨is_*, has_*å‰ç¼€: ä¾‹å¦‚`is_valid`, `has_changed`
   - ä¿æŒä¸€è‡´æ€§: åœ¨ä¸åŒæ–¹æ³•ä¸­ä½¿ç”¨ç›¸åŒçš„å‚æ•°åè¡¨ç¤ºç›¸åŒçš„æ¦‚å¿µ

### 9.2 å…³é”®æ¥å£è§„èŒƒ

1. **LearningDataRepository**
   - `save_packaging_record(target_weight, actual_weight, packaging_time, parameters, material_type=None)`
   - `get_recent_records(limit=100, target_weight=None, material_type=None)`
   - `save_parameter_adjustment(parameter_name, old_value, new_value, reason=None, related_record_id=None)`

2. **AdaptiveController**
   - `analyze_recent_performance(target_weight, material_type=None, record_limit=20)`
   - `adjust_parameters(target_weight, actual_weight, packaging_time, current_params)`
   - `get_optimal_parameters(target_weight, material_type=None)`

3. **SensitivityAnalysisEngine**
   - `calculate_parameter_sensitivity(parameter_name, target_weight=None, time_range=None)`
   - `get_most_sensitive_parameters(target_weight=None, top_n=3)`

### 9.3 å¼‚å¸¸å¤„ç†è§„èŒƒ

1. **å¼‚å¸¸ä¼ é€’åŸåˆ™**
   - åº•å±‚å¼‚å¸¸åº”è¯¥è¢«æ•è·å¹¶è½¬æ¢ä¸ºæœ‰æ„ä¹‰çš„ä¸šåŠ¡å¼‚å¸¸
   - å…³é”®æ–¹æ³•åº”è¯¥æœ‰æ˜ç¡®çš„å¼‚å¸¸å¤„ç†ç­–ç•¥
   - é¿å…åæ²¡å¼‚å¸¸ï¼Œç¡®ä¿é”™è¯¯å¯è¿½è¸ª

2. **æ—¥å¿—è®°å½•è§„èŒƒ**
   - ä½¿ç”¨f-stringæ ¼å¼åŒ–æ—¥å¿—: `logger.info(f"ä¸ºç›®æ ‡é‡é‡ {target_weight}g ç”Ÿæˆä¼˜åŒ–å‚æ•°: {optimal_params}")`
   - æ—¥å¿—çº§åˆ«æ˜ç¡®: DEBUG(è°ƒè¯•), INFO(æµç¨‹), WARNING(è­¦å‘Š), ERROR(é”™è¯¯), CRITICAL(è‡´å‘½)
   - å¼‚å¸¸æ—¥å¿—åº”åŒ…å«è¶³å¤Ÿä¸Šä¸‹æ–‡ä¿¡æ¯ä¾¿äºæ’æŸ¥

## 10. å®æ–½è¿›å±•ä¸å½“å‰çŠ¶æ€

### 10.1 æ•´ä½“è¿›åº¦æ¦‚è§ˆ

- âœ… **é˜¶æ®µä¸€ï¼šæ•°æ®åŸºç¡€è®¾æ–½** - å·²å®Œæˆ
- ğŸ”„ **é˜¶æ®µäºŒï¼šå¾®è°ƒæ§åˆ¶å™¨** - è¿›è¡Œä¸­ï¼ˆçº¦70%å®Œæˆï¼‰
- â³ **é˜¶æ®µä¸‰ï¼šæ™ºèƒ½åˆ†æå¼•æ“** - æœªå¼€å§‹
- â³ **é˜¶æ®µå››ï¼šå¯è§†åŒ–ä¸ç”¨æˆ·äº¤äº’** - æœªå¼€å§‹

### 10.2 é˜¶æ®µä¸€å®Œæˆæƒ…å†µ

æ•°æ®åŸºç¡€è®¾æ–½å±‚å·²å®Œå…¨å®ç°ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å…³é”®æˆæœï¼š

1. **æ•°æ®åº“ç»“æ„è®¾è®¡ä¸å®ç°**
   - å®ŒæˆSQLiteæ•°æ®åº“æ¶æ„è®¾è®¡å’Œåˆ›å»º
   - å®ç°äº†åŒ…è£…è®°å½•ã€å‚æ•°è®°å½•ã€å‚æ•°è°ƒæ•´å†å²ã€æ•æ„Ÿåº¦ç»“æœå’Œç‰©æ–™ç‰¹æ€§ç­‰è¡¨
   - æ–°å¢å›é€€äº‹ä»¶è®°å½•è¡¨ï¼Œæ”¯æŒå‚æ•°å›é€€è·Ÿè¸ª

2. **LearningDataRepositoryå®ç°**
   - å®Œæˆæ‰€æœ‰CRUDæ“ä½œæ–¹æ³•
   - å®ç°æ•°æ®æŸ¥è¯¢æ¥å£å’Œç»Ÿè®¡åˆ†æåŠŸèƒ½
   - æ·»åŠ æ•°æ®å¯¼å‡ºã€å¯¼å…¥å’Œå¤‡ä»½åŠŸèƒ½
   - å®ç°å›é€€äº‹ä»¶è®°å½•å’ŒæŸ¥è¯¢åŠŸèƒ½

3. **æµ‹è¯•ç¯å¢ƒä¼˜åŒ–**
   - åˆ›å»º`path_setup.py`æ¨¡å—è§£å†³æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜
   - ä¿®å¤æµ‹è¯•è„šæœ¬ä¸­çš„ç›¸å¯¹å¯¼å…¥è¯­æ³•é”™è¯¯
   - ç¡®ä¿æµ‹è¯•ç¯å¢ƒçš„ç¨³å®šå¯é è¿è¡Œ

4. **æ¥å£æ ‡å‡†åŒ–**
   - ç»Ÿä¸€å‘½åè§„èŒƒï¼Œå°†`add_packaging_record`æ›´åä¸º`save_packaging_record`
   - ä¿®å¤å¤šå¤„æ–¹æ³•å‚æ•°å’Œé€»è¾‘ä¸ä¸€è‡´é—®é¢˜
   - å»ºç«‹æ¥å£è®¾è®¡è§„èŒƒï¼Œè®°å½•åœ¨æ–‡æ¡£ä¸­

5. **æ•°æ®å¯è§†åŒ–æ”¹è¿›**
   - ä¿®å¤DataFrameè®¿é—®é—®é¢˜
   - ä¼˜åŒ–å‚æ•°å¯è§†åŒ–å¤„ç†æµç¨‹
   - æé«˜æ•°æ®ç»“æ„è®¿é—®çš„ç¨³å®šæ€§

### 10.3 é˜¶æ®µäºŒè¿›è¡ŒçŠ¶æ€

å¾®è°ƒæ§åˆ¶å™¨å¼€å‘æ­£åœ¨è¿›è¡Œä¸­ï¼Œå½“å‰è¿›åº¦çº¦70%ï¼Œä¸»è¦è¿›å±•å¦‚ä¸‹ï¼š

#### 10.3.1 å·²å®ŒæˆåŠŸèƒ½

1. **å¾®è°ƒæ§åˆ¶å™¨åŸºç¡€æ¶æ„**
   - åŸºäº`AdaptiveThreeStageController`å®ç°äº†`AdaptiveControllerWithMicroAdjustment`ç±»
   - æˆåŠŸé›†æˆäº†æ•°æ®è®°å½•åŠŸèƒ½ä¸å­¦ä¹ æ•°æ®ä»“åº“
   - å®ç°äº†ä¸ç°æœ‰ç³»ç»Ÿçš„å…¼å®¹æ¥å£

2. **å‚æ•°çº¦æŸç³»ç»Ÿ**
   - å®ç°äº†åŸºäºç›®æ ‡é‡é‡çš„åŠ¨æ€å‚æ•°å®‰å…¨è¾¹ç•Œè®¡ç®—
   - æ·»åŠ äº†å‚æ•°éªŒè¯å’Œè‡ªåŠ¨ä¿®æ­£æœºåˆ¶
   - âœ… ä¿®å¤äº†è¾¹ç•Œè®¡ç®—é€»è¾‘é—®é¢˜ï¼Œç¡®ä¿æœ€å°å€¼ä¸å¤§äºæœ€å¤§å€¼

3. **å‚æ•°å›é€€æœºåˆ¶**
   - å®ç°äº†æ‰‹åŠ¨å›é€€åŠŸèƒ½
   - æ·»åŠ äº†è‡ªåŠ¨å›é€€è§¦å‘æ¡ä»¶
   - å®ç°äº†å›é€€äº‹ä»¶è®°å½•

#### 10.3.2 å½“å‰è¿›è¡Œä¸­åŠŸèƒ½

1. **éœ‡è¡æ£€æµ‹ä¸é˜²æ­¢æœºåˆ¶**
   - å®ŒæˆåŸºæœ¬éœ‡è¡æ£€æµ‹é€»è¾‘
   - å®ç°è®¡æ•°å™¨ç´¯ç§¯æœºåˆ¶
   - ğŸ”„ æ­£åœ¨ä¿®å¤éœ‡è¡æ£€æµ‹æµ‹è¯•é—®é¢˜ï¼Œç›®å‰éœ‡è¡è®¡æ•°æ— æ³•æ­£ç¡®ç´¯ç§¯åˆ°è§¦å‘é˜ˆå€¼

2. **æµ‹è¯•æ¡†æ¶**
   - å®Œæˆå‚æ•°è¾¹ç•Œè®¡ç®—æµ‹è¯•
   - ğŸ”„ æ­£åœ¨è°ƒè¯•éœ‡è¡æ£€æµ‹æµ‹è¯•
   - å‡†å¤‡å›é€€æœºåˆ¶æµ‹è¯•å’Œå®Œæ•´æ¨¡æ‹Ÿæµ‹è¯•

#### 10.3.3 æŠ€æœ¯æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ

1. **å‚æ•°è¾¹ç•Œè®¡ç®—é—®é¢˜**
   - **é—®é¢˜**ï¼šå½“ç›®æ ‡é‡é‡ä¸å‚æ•°æ¯”ä¾‹å› å­ç»„åˆè¶…å‡ºé»˜è®¤è¾¹ç•Œæ—¶ï¼Œä¼šå¯¼è‡´è®¡ç®—å‡ºçš„æœ€å°å€¼å¤§äºæœ€å¤§å€¼
   - **è§£å†³æ–¹æ¡ˆ**ï¼šæ·»åŠ æ˜¾å¼æ£€æŸ¥ï¼Œç¡®ä¿è®¡ç®—å‡ºçš„è¾¹ç•Œæœ‰æ•ˆï¼Œæ— æ•ˆæ—¶ä½¿ç”¨åˆç†çš„é»˜è®¤å€¼
   - **çŠ¶æ€**ï¼šå·²è§£å†³

2. **éœ‡è¡æ£€æµ‹æ•æ„Ÿåº¦é—®é¢˜**
   - **é—®é¢˜**ï¼šå½“å‰éœ‡è¡æ£€æµ‹æœºåˆ¶åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä¸å¤Ÿæ•æ„Ÿï¼Œæ— æ³•æ­£ç¡®è¯†åˆ«æ¨¡æ‹Ÿçš„éœ‡è¡æ¨¡å¼
   - **è§£å†³æ€è·¯**ï¼š
     - æ”¹è¿›æ–¹å‘å˜åŒ–æ£€æµ‹ç®—æ³•ï¼Œæé«˜å¯¹çŸ­æœŸéœ‡è¡çš„æ•æ„Ÿåº¦
     - ä¼˜åŒ–è®¡æ•°å™¨ç´¯ç§¯é€»è¾‘ï¼Œç¡®ä¿è¿ç»­çš„å¾®å°éœ‡è¡èƒ½è¢«æ­£ç¡®æ£€æµ‹
     - æ·»åŠ æµ‹è¯•æ¨¡å¼ç‰¹æ®Šå¤„ç†ï¼Œé’ˆå¯¹æµ‹è¯•ç¯å¢ƒä¼˜åŒ–æ£€æµ‹é€»è¾‘
   - **çŠ¶æ€**ï¼šè§£å†³ä¸­

3. **æµ‹è¯•ç¯å¢ƒä¸çœŸå®ç¯å¢ƒå·®å¼‚**
   - **é—®é¢˜**ï¼šæµ‹è¯•ç¯å¢ƒä¸­æ‰‹åŠ¨æ¨¡æ‹Ÿçš„å‚æ•°å˜åŒ–ä¸å®é™…ç³»ç»Ÿè¿è¡Œæ—¶çš„è‡ªåŠ¨è°ƒæ•´å­˜åœ¨å·®å¼‚
   - **è§£å†³æ€è·¯**ï¼š
     - å¢å¼º`WeighingSystemSimulator`æ¨¡æ‹Ÿå™¨ï¼Œæ›´å‡†ç¡®æ¨¡æ‹ŸçœŸå®ç‰©ç†ç³»ç»Ÿ
     - è°ƒæ•´æµ‹è¯•ç”¨ä¾‹ï¼Œä½¿å…¶æ›´æ¥è¿‘å®é™…è¿è¡Œåœºæ™¯
     - æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼Œæ›´å¥½åœ°ç†è§£æµ‹è¯•å¤±è´¥åŸå› 
   - **çŠ¶æ€**ï¼šè§£å†³ä¸­

### 10.4 ä¸‹ä¸€æ­¥è®¡åˆ’

1. **çŸ­æœŸè®¡åˆ’**ï¼ˆ1-2å‘¨ï¼‰
   - å®Œæˆéœ‡è¡æ£€æµ‹åŠŸèƒ½ä¿®å¤
   - å®Œæˆæ‰€æœ‰å•å…ƒæµ‹è¯•
   - é›†æˆæµ‹è¯•å¾®è°ƒæ§åˆ¶å™¨ä¸ç°æœ‰ç³»ç»Ÿ
   - ç¼–å†™è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£

2. **ä¸­æœŸè®¡åˆ’**ï¼ˆ3-4å‘¨ï¼‰
   - å¼€å§‹é˜¶æ®µä¸‰ï¼šæ™ºèƒ½åˆ†æå¼•æ“å¼€å‘
   - å®ç°å‚æ•°æ•æ„Ÿåº¦åˆ†æ
   - å¼€å‘ç‰©æ–™ç‰¹æ€§è¯†åˆ«åˆæ­¥åŠŸèƒ½
   
3. **å…³é”®é‡Œç¨‹ç¢‘**
   - å¾®è°ƒæ§åˆ¶å™¨å®Œæ•´åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼ˆé¢„è®¡æœ¬å‘¨æœ«ï¼‰
   - å¾®è°ƒæ§åˆ¶å™¨ä¸ä¸»ç³»ç»Ÿé›†æˆå®Œæˆï¼ˆé¢„è®¡ä¸‹å‘¨åˆï¼‰
   - æ•æ„Ÿåº¦åˆ†æå¼•æ“åŸå‹ï¼ˆé¢„è®¡4å‘¨å†…ï¼‰

### 10.5 èµ„æºåˆ†é…

å½“å‰åˆ†é…åˆ°å¾®è°ƒæ§åˆ¶å™¨å¼€å‘çš„èµ„æºï¼š
- å¼€å‘äººå‘˜ï¼š1åå…¨èŒ
- æµ‹è¯•äººå‘˜ï¼š1åå…¼èŒ
- é¢„è®¡å®Œæˆå‰©ä½™å·¥ä½œæ‰€éœ€æ—¶é—´ï¼š2å‘¨

### 10.6 é£é™©æ›´æ–°

| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ | çŠ¶æ€ |
|------|-------|------|---------|------|
| éœ‡è¡æ£€æµ‹ç®—æ³•ä¸å¤Ÿç¨³å®š | é«˜ | ä¸­ | æ”¹è¿›ç®—æ³•ï¼Œå¢åŠ æµ‹è¯•è¦†ç›– | æ­£åœ¨å¤„ç† |
| å‚æ•°è¾¹ç•Œè®¡ç®—é”™è¯¯ | ä½ | é«˜ | å·²ä¿®å¤å¹¶æ·»åŠ éªŒè¯ | å·²è§£å†³ |
| å›é€€æœºåˆ¶å¯èƒ½å¯¼è‡´æ€§èƒ½æ³¢åŠ¨ | ä¸­ | ä¸­ | å®ç°å¹³æ»‘è¿‡æ¸¡ï¼Œå¢åŠ ç”¨æˆ·æ§åˆ¶ | ç›‘æ§ä¸­ |
| ä¸ä¸»ç³»ç»Ÿé›†æˆé—®é¢˜ | ä¸­ | é«˜ | ä¿æŒæ¥å£å…¼å®¹ï¼Œå¢åŠ å•å…ƒæµ‹è¯• | æœªå¼€å§‹ |

### 10.7 é˜¶æ®µè¯„ä¼°

é˜¶æ®µä¸€å·²å®Œæˆï¼Œè¯„ä¼°ç»“æœï¼š
- **ç›®æ ‡è¾¾æˆ**ï¼šå®Œå…¨è¾¾æˆï¼Œæ‰€æœ‰è®¡åˆ’åŠŸèƒ½å·²å®ç°
- **ä»£ç è´¨é‡**ï¼šè‰¯å¥½ï¼Œé€šè¿‡æ‰€æœ‰å•å…ƒæµ‹è¯•
- **æ€§èƒ½è¡¨ç°**ï¼šæ»¡è¶³è¦æ±‚ï¼Œæ•°æ®æ“ä½œå“åº”æ—¶é—´<100ms
- **æ–‡æ¡£å®Œæ•´æ€§**ï¼šå®Œå–„ï¼ŒåŒ…æ‹¬APIå‚è€ƒå’Œä½¿ç”¨ç¤ºä¾‹

é˜¶æ®µäºŒè¿›è¡Œä¸­ï¼Œåˆæ­¥è¯„ä¼°ï¼š
- **ç›®æ ‡è¾¾æˆ**ï¼š70%ï¼Œæ ¸å¿ƒåŠŸèƒ½å·²å®ç°ä½†ä»æœ‰æµ‹è¯•é—®é¢˜
- **æ—¶é—´è¿›åº¦**ï¼šç•¥æœ‰å»¶è¿Ÿï¼Œä½†é¢„è®¡å¯ä»¥æŒ‰è®¡åˆ’å®Œæˆ
- **ä¸»è¦é—®é¢˜**ï¼šéœ‡è¡æ£€æµ‹ç®—æ³•æ•æ„Ÿåº¦éœ€è¦ä¼˜åŒ–
